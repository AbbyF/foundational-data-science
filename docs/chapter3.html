<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Foundational Data Science</title>
  <meta name="description" content="This course provides a firm foundation on the fundamentals of data science using R, with a focus on key statistical methods, exploratory data analysis, and visualizations. Before worrying about advanced analytics and neural nets, it is important to master the core skills. While this is certainly not a mathematical course, we won’t shy away from giving insight into the underlying mathematical theory.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Foundational Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://csgillespie.github.io/foundational-data-science/" />
  
  <meta property="og:description" content="This course provides a firm foundation on the fundamentals of data science using R, with a focus on key statistical methods, exploratory data analysis, and visualizations. Before worrying about advanced analytics and neural nets, it is important to master the core skills. While this is certainly not a mathematical course, we won’t shy away from giving insight into the underlying mathematical theory." />
  <meta name="github-repo" content="csgillespie/foundational-data-science" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Foundational Data Science" />
  <meta name="twitter:site" content="@csgillespie" />
  <meta name="twitter:description" content="This course provides a firm foundation on the fundamentals of data science using R, with a focus on key statistical methods, exploratory data analysis, and visualizations. Before worrying about advanced analytics and neural nets, it is important to master the core skills. While this is certainly not a mathematical course, we won’t shy away from giving insight into the underlying mathematical theory." />
  

<meta name="author" content="Colin Gillespie">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapter2.html">
<link rel="next" href="chapter4.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Foundational Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Author</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#book-overview"><i class="fa fa-check"></i><b>1.1</b> Book overview</a><ul>
<li class="chapter" data-level="1.1.1" data-path="chapter1.html"><a href="chapter1.html#the-trouble-with-tibbles-data"><i class="fa fa-check"></i><b>1.1.1</b> The trouble with <del>tibbles</del> data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#talking-about-data"><i class="fa fa-check"></i><b>1.2</b> Talking about data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#sample-size"><i class="fa fa-check"></i><b>1.2.1</b> Sample size</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#designing-the-experiment"><i class="fa fa-check"></i><b>1.3</b> Designing the experiment</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#data-sets"><i class="fa fa-check"></i><b>1.4</b> Data sets</a><ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#the-relationship-between-beauty-and-teaching"><i class="fa fa-check"></i><b>1.4.1</b> The relationship between beauty and teaching</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#bond-james-bond"><i class="fa fa-check"></i><b>1.4.2</b> Bond, James Bond</a></li>
<li class="chapter" data-level="1.4.3" data-path="chapter1.html"><a href="chapter1.html#okcupid"><i class="fa fa-check"></i><b>1.4.3</b> OKCupid</a></li>
<li class="chapter" data-level="1.4.4" data-path="chapter1.html"><a href="chapter1.html#starbucks"><i class="fa fa-check"></i><b>1.4.4</b> Starbucks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Condensing data with numerical summaries</a><ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#mathematical-notation"><i class="fa fa-check"></i><b>2.1</b> Mathematical notation</a></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#measures-of-location"><i class="fa fa-check"></i><b>2.2</b> Measures of location</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#sample-mean"><i class="fa fa-check"></i><b>2.2.1</b> Sample mean</a></li>
<li class="chapter" data-level="" data-path="chapter2.html"><a href="chapter2.html#example-the-beauty-data-set"><i class="fa fa-check"></i>Example: The beauty data set</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#sample-median"><i class="fa fa-check"></i><b>2.2.2</b> Sample median</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#measures-of-spread"><i class="fa fa-check"></i><b>2.3</b> Measures of spread</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#range"><i class="fa fa-check"></i><b>2.3.1</b> Range</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#sample-variance-and-standard-deviation"><i class="fa fa-check"></i><b>2.3.2</b> Sample variance and standard deviation</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#quartiles-and-the-interquartile-range"><i class="fa fa-check"></i><b>2.3.3</b> Quartiles and the interquartile range</a></li>
<li class="chapter" data-level="2.3.4" data-path="chapter2.html"><a href="chapter2.html#numerical-examples"><i class="fa fa-check"></i><b>2.3.4</b> Numerical examples</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#streaming-data"><i class="fa fa-check"></i><b>2.4</b> Streaming data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapter2.html"><a href="chapter2.html#the-mean-and-variance"><i class="fa fa-check"></i><b>2.4.1</b> The mean and variance</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapter2.html"><a href="chapter2.html#the-median-and-quantiles"><i class="fa fa-check"></i><b>2.4.2</b> The median and quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter2.html"><a href="chapter2.html#relevant-r-functions"><i class="fa fa-check"></i>Relevant R functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> What, why and how of visualisation</a><ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#historical-visualisations"><i class="fa fa-check"></i><b>3.1</b> Historical visualisations</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#scatter-plots"><i class="fa fa-check"></i><b>3.2</b> Scatter plots</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#styling-your-plot"><i class="fa fa-check"></i><b>3.2.1</b> Styling your plot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#histograms"><i class="fa fa-check"></i><b>3.3</b> Histograms</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#density-plots"><i class="fa fa-check"></i><b>3.4</b> Density plots</a><ul>
<li class="chapter" data-level="3.4.1" data-path="chapter3.html"><a href="chapter3.html#detailed-explanation"><i class="fa fa-check"></i><b>3.4.1</b> Detailed explanation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#boxplots"><i class="fa fa-check"></i><b>3.5</b> Boxplots</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#barplots"><i class="fa fa-check"></i><b>3.6</b> Barplots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> The normal distribution - what’s the point?</a><ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#the-bernoulli-distribution"><i class="fa fa-check"></i><b>4.1</b> The Bernoulli distribution</a><ul>
<li class="chapter" data-level="4.1.1" data-path="chapter4.html"><a href="chapter4.html#motivating-example"><i class="fa fa-check"></i><b>4.1.1</b> Motivating example</a></li>
<li class="chapter" data-level="4.1.2" data-path="chapter4.html"><a href="chapter4.html#description"><i class="fa fa-check"></i><b>4.1.2</b> Description</a></li>
<li class="chapter" data-level="4.1.3" data-path="chapter4.html"><a href="chapter4.html#example"><i class="fa fa-check"></i><b>4.1.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#the-binomial-distribution"><i class="fa fa-check"></i><b>4.2</b> The Binomial distribution</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chapter4.html"><a href="chapter4.html#motivating-example-1"><i class="fa fa-check"></i><b>4.2.1</b> Motivating example</a></li>
<li class="chapter" data-level="4.2.2" data-path="chapter4.html"><a href="chapter4.html#description-1"><i class="fa fa-check"></i><b>4.2.2</b> Description</a></li>
<li class="chapter" data-level="4.2.3" data-path="chapter4.html"><a href="chapter4.html#what-does-the-binomial-distribution-look-like"><i class="fa fa-check"></i><b>4.2.3</b> What does the Binomial distribution look like?</a></li>
<li class="chapter" data-level="4.2.4" data-path="chapter4.html"><a href="chapter4.html#motivating-example-2"><i class="fa fa-check"></i><b>4.2.4</b> Motivating example</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#the-normalgaussian-distribution"><i class="fa fa-check"></i><b>4.3</b> The Normal/Gaussian distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#continuous-and-discrete-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Continuous and discrete distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#the-standard-deviations-rule"><i class="fa fa-check"></i><b>4.3.2</b> The standard deviations rule</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#the-z-score"><i class="fa fa-check"></i><b>4.3.3</b> The Z-Score</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Margin of Error</a><ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#introduction-motativating-example"><i class="fa fa-check"></i><b>5.1</b> Introduction &amp; motativating example</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#one-sample-test"><i class="fa fa-check"></i><b>5.2</b> One sample test</a><ul>
<li class="chapter" data-level="5.2.1" data-path="chapter5.html"><a href="chapter5.html#example-okcupid-1"><i class="fa fa-check"></i><b>5.2.1</b> Example: OKCupid</a></li>
<li class="chapter" data-level="5.2.2" data-path="chapter5.html"><a href="chapter5.html#errors"><i class="fa fa-check"></i><b>5.2.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#two-sample-z-test"><i class="fa fa-check"></i><b>5.3</b> Two sample z-test</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#confidence-intervals"><i class="fa fa-check"></i><b>5.4</b> Confidence intervals</a><ul>
<li class="chapter" data-level="5.4.1" data-path="chapter5.html"><a href="chapter5.html#construction"><i class="fa fa-check"></i><b>5.4.1</b> Construction</a></li>
<li class="chapter" data-level="5.4.2" data-path="chapter5.html"><a href="chapter5.html#example-comic-sans"><i class="fa fa-check"></i><b>5.4.2</b> Example: Comic Sans</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#the-central-limit-therem-clt"><i class="fa fa-check"></i><b>5.5</b> The Central Limit Therem (CLT)</a><ul>
<li class="chapter" data-level="5.5.1" data-path="chapter5.html"><a href="chapter5.html#example-customer-waiting-times"><i class="fa fa-check"></i><b>5.5.1</b> Example: Customer waiting times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Capturing relationships with linear regression</a><ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#capturing-linear-relationships"><i class="fa fa-check"></i><b>6.1</b> Capturing linear relationships</a><ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#example-starbucks-calorie-content"><i class="fa fa-check"></i><b>6.1.1</b> Example: Starbucks calorie content</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#linear-regression"><i class="fa fa-check"></i><b>6.2</b> Linear Regression</a><ul>
<li class="chapter" data-level="6.2.1" data-path="chapter6.html"><a href="chapter6.html#prediction-and-interpretation"><i class="fa fa-check"></i><b>6.2.1</b> Prediction and Interpretation</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapter6.html"><a href="chapter6.html#how-do-we-estimate-the-model-coefficients"><i class="fa fa-check"></i><b>6.2.2</b> How do we estimate the model coefficients?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#multiple-linear-regression-models"><i class="fa fa-check"></i><b>6.3</b> Multiple linear regression models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Wrap-up</a></li>
<li class="divider"></li>
<li>Developed by <a href="https://jumpingrivers.com" target="blank">Jumping Rivers</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Foundational Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter3" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> What, why and how of visualisation</h1>
<!-- (90 minutes) -->
<blockquote>
<p>A picture paints a thousand words - <em>Frederick R. Barnard</em></p>
</blockquote>
<p>Data visualisation is an old topic; but in the last few years, it’s become particularly trendy. With the correct visualisation, we can highlight key features that don’t require any fancy statistics.</p>
<div id="prerequisites-1" class="section level4 unnumbered">
<h4>Prerequisites</h4>
<p>We could have an entire course on creating graphics, but in this chapter we’ll concentrate on the fundamentals. To make this section concrete, we’ll use the <a href="http://ggplot2.tidyverse.org/"><strong>ggplot2</strong></a> package within R. However, there are many libraries available to generate the graphics in other languages. For example, in Javascript we could use <code>d3</code>, or <code>seaborn</code> in python.</p>
<p>The <strong>ggplot2</strong> and <strong>hrbrthemes</strong> packages can be easily installed via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;hrbrthemes&quot;</span>))</code></pre></div>
<p>and loaded in the usual way, e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;hrbrthemes&quot;</span>)</code></pre></div>
</div>
<div id="historical-visualisations" class="section level2">
<h2><span class="header-section-number">3.1</span> Historical visualisations</h2>
<p>John Snow<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> created a simple dot map to illustrate the cluster of cholera cases around a water pump - figure <a href="chapter3.html#fig:3-1">3.1</a>. This allowed him to show the connection between the quality of the water source and cholera cases. He was able to demonstrate that the Southwark and Vauxhall Waterworks Company was taking water from sewage-polluted sections of the Thames and delivering the water to home. Thereby leading to an increased incidence of cholera. This study is a major event in the history of public health and geography. It is regarded as the founding event of the science of epidemiology.</p>

<div class="figure" style="text-align: center"><span id="fig:3-1"></span>
<img src="graphics/Snow-cholera-map-1.jpg" alt="John Snow dot map of cholera cases (https://en.wikipedia.org/wiki/John_Snow)." width="60%" />
<p class="caption">
Figure 3.1: John Snow dot map of cholera cases (<a href="https://en.wikipedia.org/wiki/John_Snow" class="uri">https://en.wikipedia.org/wiki/John_Snow</a>).
</p>
</div>
<p>The Hereford Mappa Mundi dates from around 1300 - figure <a href="chapter3.html#fig:3-2">3.2</a>. It is currently on display at Hereford Cathedral in <a href="https://goo.gl/maps/EQpxywNkjbB2">Hereford</a>, England. It is the largest medieval map known still to exist. At the centre of the map is Jerusalem, in the bottom left is the UK, at the top is the garden of Eden (some of the data points are approximate!)</p>

<div class="figure" style="text-align: center"><span id="fig:3-2"></span>
<img src="graphics/hereford.jpg" alt="Hereford Mappa Mundi (https://en.wikipedia.org/wiki/Hereford_Mappa_Mundi)." width="60%" />
<p class="caption">
Figure 3.2: Hereford Mappa Mundi (<a href="https://en.wikipedia.org/wiki/Hereford_Mappa_Mundi" class="uri">https://en.wikipedia.org/wiki/Hereford_Mappa_Mundi</a>).
</p>
</div>
<p><a href="https://en.wikipedia.org/wiki/Florence_Nightingale">Florence Nightingale</a> is described as “a true pioneer in the graphical representation of statistics”. Her diagram about the causes of mortality in the army (figure <a href="chapter3.html#fig:3-3">3.3</a>), was ground breaking. Florence’s graph showed that sanitation was a major killer in the army. After successfully lobbying the government, the mortality rate dropped from 69 to 18 per 1000.</p>

<div class="figure" style="text-align: center"><span id="fig:3-3"></span>
<img src="graphics/Nightingale-mortality.jpg" alt="Diagram of the causes of mortality in the army in the East by Florence Nightingale." width="60%" />
<p class="caption">
Figure 3.3: Diagram of the causes of mortality in the army in the East by <a href="https://en.wikipedia.org/wiki/Florence_Nightingale">Florence Nightingale</a>.
</p>
</div>
<p>Visualisation is incredibly important. Whenever I get a data set, I automatically start generating plots to get a feel for the data. It helps us to detect interesting patterns in the data; remember plotting can save lives (if you’re Florence Nightingale).</p>
</div>
<div id="scatter-plots" class="section level2">
<h2><span class="header-section-number">3.2</span> Scatter plots</h2>
<p>A scatter plot has horizontal and vertical axes to plot data points. Typically they are used to show how one variables is affected by another. Let’s start with a simple scatter plot of looking at whether the Bond movies have become more violent over time. In ggplot, we first specify a <em>canvas</em> and then add subsequent layers using the <code>+</code> operator</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bond, <span class="kw">aes</span>(<span class="dt">x =</span> Number, <span class="dt">y =</span> Kills)) <span class="op">+</span><span class="st"> </span><span class="co"># Create a canvas</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="co"># Add a layer of points</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-4"></span>
<img src="_main_files/figure-html/3-4-1.png" alt="Has Bond got more violent?" width="60%" />
<p class="caption">
Figure 3.4: Has Bond got more violent?
</p>
</div>
<p>On the <span class="math inline">\(x\)</span>-axis we have the movie number (chronological movie order) and on the <span class="math inline">\(y\)</span>-axis we have the number of kills made by Bond. The scatter plot does show a general trend, with an increased number of deaths in latter movies.</p>
<p>Figure <a href="chapter3.html#fig:3-4">3.4</a> is OK, but could be significantly improved.</p>
<div class="rmdnote">
<p>
There’s a lot going on in the code used to generate the figure. The first argument is the data frame <code>bond</code>, while <code>aes</code> argument specifies what elements in the plot should change with a variable.
</p>
</div>
<p>First we’ll use colour to differentiate between actors and fix the axis limits</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g =<span class="st"> </span><span class="kw">ggplot</span>(bond, <span class="kw">aes</span>(<span class="dt">x =</span> Number, <span class="dt">y =</span> Kills)) <span class="op">+</span><span class="st"> </span><span class="co"># Create a canvas</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Actor)) <span class="op">+</span><span class="st"> </span><span class="co"># Add a layer of points</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>))  
g <span class="co"># With ggplot we can store the graph construct</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-5"></span>
<img src="_main_files/figure-html/3-5-1.png" alt="Using colour to differentiate between actors." width="60%" />
<p class="caption">
Figure 3.5: Using colour to differentiate between actors.
</p>
</div>
<p>By using colour, we can see that Pierce was a particularly violent Bond, with the green points in the top right hand corner.</p>
<p>Next we can add a trend line to get a feel for the relationship over time. The <code>stat_smooth()</code> layer adds a local trend line. Essentially, the line moves along the <span class="math inline">\(x\)</span>-axis and the gradient is only affected by nearby points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g_smooth =<span class="st"> </span>g <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">colour =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>)
g_smooth</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-6"></span>
<img src="_main_files/figure-html/3-6-1.png" alt="Capturing the trend." width="60%" />
<p class="caption">
Figure 3.6: Capturing the trend.
</p>
</div>
<p>This graph now contains some useful insight.</p>
<ol style="list-style-type: decimal">
<li>The number of kills appears to be increasing with each bond movie.</li>
<li>Pierce Brosnan (the green points) liked killing people.</li>
<li>Daniel Craig’s movies didn’t contain (that) many deaths.</li>
</ol>
<div id="styling-your-plot" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Styling your plot</h3>
<p>If the graph is only going to be consumed by the data scientist, then there is no need to spend time polishing the final product. However if the graph is to be used to convince or highlight issues for other people, then some time and effort needs to be spent.</p>
<p><strong>ggplot2</strong> has the concept of themes that can style the plot. Here we use the <a href="https://github.com/hrbrmstr/hrbrthemes">hrbrthemes</a> package. It provides</p>
<blockquote>
<p>typography-centric themes and theme components for ggplot2</p>
</blockquote>
<p>Basically, it’s opinionated. The package enables us to change the background colour, tweak the palette and add proper labels, with minimal effort</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(hrbrthemes)
g_smooth <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_ipsum</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_color_ipsum</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Movie number&quot;</span>, 
       <span class="dt">y =</span> <span class="st">&quot;No. of Bond Kills&quot;</span>,
       <span class="dt">title =</span> <span class="st">&quot;Kills through time&quot;</span>,
       <span class="dt">subtitle =</span> <span class="st">&quot;Is there a relationship?&quot;</span>,
       <span class="dt">caption =</span> <span class="st">&quot;Pierce wasn&#39;t a nice man!&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-7"></span>
<img src="_main_files/figure-html/3-7-1.png" alt="Pimping your graph with the hrbrthemes package." width="75%" />
<p class="caption">
Figure 3.7: Pimping your graph with the hrbrthemes package.
</p>
</div>
<p>With little effort, we’ve gone from something basic - figure <a href="chapter3.html#fig:3-4">3.4</a> - to a high quality, publication ready figure, <a href="chapter3.html#fig:3-7">3.7</a>. Unfortunately, we have limited time to spend on graph aesthetics.</p>
<div id="exercise-q-a" class="section level4 unnumbered">
<h4>Exercise / Q &amp; A</h4>
<!-- (25 minutes) -->
<ul>
<li>Does alcohol consumption change through time?</li>
<li>Does there appear to a relationship between alcohol and the number of kills?</li>
<li>Change method from <code>smooth</code> to <code>lm</code>.</li>
</ul>
</div>
</div>
</div>
<div id="histograms" class="section level2">
<h2><span class="header-section-number">3.3</span> Histograms</h2>
<p>A histogram is a graphical representation of the distribution of continuous, numerical data. If the area under the graph adds up to one, then it is a <em>probability</em> distribution. Constructing a histogram is straightforward; we divide the entire range into a series of intervals and count how many values fall into each interval. Bins do not have to be the same size (but they probably should be in general).</p>
<p>We’ll start with a histogram of users ages from the OKCupid dataset. To create a histogram, we use the <code>geom_histogram()</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cupid, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) </code></pre></div>
<p>This creates the left plot in figure <a href="chapter3.html#fig:3-8">3.8</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:3-8"></span>
<img src="_main_files/figure-html/3-8-1.png" alt="Age distribution of the OKCupid data set." width="80%" />
<p class="caption">
Figure 3.8: Age distribution of the OKCupid data set.
</p>
</div>
<p>Notice in the code we’ve specified <code>binwidth = 1</code>. This means that the binwidth is equal 1 year. The default (in ggplot2) is to create a plot using 30 bins, it’s always a good idea to explore the effect of varying the binwidth. In particular, if you look carefully at the plot where the <code>binwidth = 1</code>, we can see a spike at <code>age = 42</code>. Another interesting feature is the long tail - this is an example of a <em>right skewed</em> or <em>positively skewed</em> data set.</p>
<p>Often we want to split a plot up by different variables, for example, the users <code>gender</code>. This is easy with <strong>ggplot2</strong>; we just add on an additional call to <code>facet_wrap()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cupid, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>sex) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">80</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-9"></span>
<img src="_main_files/figure-html/3-9-1.png" alt="OKCupid age distribution by gender." width="70%" />
<p class="caption">
Figure 3.9: OKCupid age distribution by gender.
</p>
</div>
<p>By splitting age by gender, two interesting features become apparent from figure <a href="chapter3.html#fig:3-9">3.9</a></p>
<ol style="list-style-type: decimal">
<li>There are many more male OK Cupid users than female (not surprising).</li>
<li>The general age distribution looks similar between sexes.</li>
<li>The most surprising aspect is that the spike in age 42 is due to female users. This could be by pure chance, users lying about their age, or a mistake in data entry.</li>
</ol>
</div>
<div id="density-plots" class="section level2">
<h2><span class="header-section-number">3.4</span> Density plots</h2>
<p>A downside of using a histogram, is that putting two histograms on top of each other makes the graphic cluttered and unclear (of course you can use panels as above). An alternative method is to use a <em>kernel density estimator</em>. Essentially we draw a line around the histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cupid, <span class="kw">aes</span>(<span class="dt">x =</span> age)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">80</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-10"></span>
<img src="_main_files/figure-html/3-10-1.png" alt="Kernel density plots of the ages." width="60%" />
<p class="caption">
Figure 3.10: Kernel density plots of the ages.
</p>
</div>
<p>Since the distributions are represented as lines, we can plot multiple distributions on top of each other. By plotting in this way, it becomes obvious the distributions of each gender are similar. <em>However</em>, we have smoothed over the bump at age 42.</p>
<div id="detailed-explanation" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Detailed explanation</h3>
<p>This section aims to give gentle introduction to how kernel density plots are actually constructed. Behind the scenes, there’s some nice mathematical theory the underpins this graph. However, we’ll avoid the maths and concentrate on the intuition.</p>
<p>Suppose we have three points: (-2, -1, 2). These points are shown in figure <a href="chapter3.html#fig:3-11">3.11</a> (a) as blue crosses. Around each point we draw a <em>kernel</em> - figure <a href="chapter3.html#fig:3-11">3.11</a> (b). The kernel can be any non-negative (but typically symmetric) function that integrates to one. For example, it could be a</p>
<ul>
<li>rectangle;</li>
<li>triangle;</li>
<li>Gaussian (or Normal) density;</li>
<li><a href="https://en.wikipedia.org/wiki/Kernel_(statistics)#Kernel_functions_in_common_use">Epanechnikov</a> function.</li>
</ul>
<p>In this example, we’ll use the most common kernel, a Gaussian or bell shaped curve. Next we combine the kernels around each point into a single common curve (figure <a href="chapter3.html#fig:3-11">3.11</a> c). Finally, we normalise the area under the kernel to be <span class="math inline">\(1\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:3-11"></span>
<img src="_main_files/figure-html/3-11-1.png" alt="How to construct a kernel density estimate." width="70%" />
<p class="caption">
Figure 3.11: How to construct a kernel density estimate.
</p>
</div>
<p>The tricky mathematical part deals with what kernel we should use and how wide that kernel should be. A wide kernel has the effect of flattening out our histogram shape, similar to having fewer bins. A narrow kernel has the opposite effect. Intuitively, when we have many points, the kernel should be narrower.</p>
</div>
</div>
<div id="boxplots" class="section level2">
<h2><span class="header-section-number">3.5</span> Boxplots</h2>
<p>A box and whisker plot, sometimes simply called a boxplot, is another way to represent continuous data. This kind of plot is particularly useful for comparing two or more groups, by placing the boxplots side-by side.</p>
<p>The central bar in the “box” is the sample <em>median</em>. The top and bottom of the box represent the upper and lower sample <em>quartiles</em>. Just as the median represents the 50% point of the data, the lower and upper quartiles represent the 25% and 75% points respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">local</span>(<span class="kw">source</span>(<span class="st">&quot;code/f3_boxplot.R&quot;</span>))</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-12"></span>
<img src="_main_files/figure-html/3-12-1.png" alt="Boxplot description." width="60%" />
<p class="caption">
Figure 3.12: Boxplot description.
</p>
</div>
<p>The lower whisker is drawn from the lower end of the box to the smallest value that is no smaller than 1.5IQR below the lower quartile. Similarly, the upper whisker is drawn from the middle of the upper end of the box to the largest value that is no larger than 1.5IQR above the upper quantile. Points outside the whiskers are classified as outliers.</p>
<p>If we wanted to compared how age varies by income level<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> then a boxplot is perfect</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Missing values are represented with a -1</span>
<span class="kw">ggplot</span>(cupid, <span class="kw">aes</span>(<span class="dt">x =</span> income, <span class="dt">y =</span> age)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:3-13"></span>
<img src="_main_files/figure-html/3-13-1.png" alt="Income by age of the OKCupid data set." width="70%" />
<p class="caption">
Figure 3.13: Income by age of the OKCupid data set.
</p>
</div>
<p>The figure highlights a gradual increase of income with age. However, for extreme incomes it drops. I suspect this pattern is particular to San Francisco!</p>
</div>
<div id="barplots" class="section level2">
<h2><span class="header-section-number">3.6</span> Barplots</h2>
<p>A bar chart or bar graph is a chart that presents grouped data with rectangular bars with lengths proportional to the values that they represent. The bars can be plotted vertically or horizontally.</p>
<p>Let’s look again at the bond dataset. To determine the number movies by each star we use <code>geom_bar()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bond) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Actor))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Typically ordering the axis alphabetically isn’t best. In this case, we could order the either by the number of movies, or by the date the actor first appeared. Again with a few minor tweaks we can go from a plot that is OK, to a plot that is informative and attractive.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-28-2.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Not <a href="https://en.wikipedia.org/wiki/Jon_Snow_(character)">that</a> Jon Snow, he knows nothing.<a href="chapter3.html#fnref4">↩</a></p></li>
<li id="fn5"><p>Income level is discrete in this dataset<a href="chapter3.html#fnref5">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-graphics.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
